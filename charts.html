<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>OWASP Metadata Analytics</title>
  <link rel="stylesheet" href="styles.css" />
  <link rel="stylesheet" href="charts.css">
</head>

<body>
  <div class="toolbar">
    <button id="toggle-theme" title="Toggle dark mode">ğŸŒ“ Theme</button>
    <button id="export-charts" title="Export data">ğŸ“Š Export</button>
    <button id="refresh-charts" title="Refresh charts">ğŸ”„ Refresh</button>
  </div>

  <div class="charts-page">
    <div class="page-header">
      <h1>OWASP Metadata Analytics</h1>
      <p class="subtitle">Comprehensive analysis of metadata across OWASP repositories</p>
    </div>

    <div class="navigation">
      <a href="index.html" class="nav-button">â† Back to Table View</a>
      <a href="diagram.html" class="nav-button">ğŸ—ºï¸ Project Diagram</a>
    </div>

    <!-- Statistics Overview -->
    <div class="stats-grid" id="stats-overview">
      <div class="stat-card">
        <div class="stat-number" id="total-repos">0</div>
        <div class="stat-label">Total Repositories</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="repos-with-metadata">0</div>
        <div class="stat-label">Repositories with Metadata</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="total-fields">0</div>
        <div class="stat-label">Unique Fields</div>
      </div>
      <div class="stat-card">
        <div class="stat-number" id="completeness-rate">0%</div>
        <div class="stat-label">Overall Completeness</div>
      </div>
    </div>

    <!-- Charts Grid -->
    <div class="charts-grid">
      <!-- Field Frequency Chart -->
      <div class="chart-container">
        <h3>Field Usage Frequency (Top 15)</h3>
        <div class="chart-wrapper">
          <canvas id="field-frequency-chart"></canvas>
          <div class="loading-chart" id="loading-field-frequency">Loading chart...</div>
        </div>
        <div class="chart-notes">Shows most commonly used metadata fields across repositories</div>
      </div>

      <!-- Completeness Distribution -->
      <div class="chart-container">
        <h3>Metadata Completeness Distribution</h3>
        <div class="chart-wrapper">
          <canvas id="completeness-chart"></canvas>
          <div class="loading-chart" id="loading-completeness">Loading chart...</div>
        </div>
        <div class="chart-notes">Distribution of repositories by metadata completeness percentage</div>
      </div>

      <!-- Top Fields by Usage -->
      <div class="chart-container">
        <h3>Top 10 Most Used Fields</h3>
        <div class="chart-wrapper">
          <canvas id="top-fields-chart"></canvas>
          <div class="loading-chart" id="loading-top-fields">Loading chart...</div>
        </div>
        <div class="chart-notes">Fields with highest adoption rates</div>
      </div>

      <!-- Least Used Fields -->
      <div class="chart-container">
        <h3>Top 10 Least Used Fields</h3>
        <div class="chart-wrapper">
          <canvas id="bottom-fields-chart"></canvas>
          <div class="loading-chart" id="loading-bottom-fields">Loading chart...</div>
        </div>
        <div class="chart-notes">Fields with lowest adoption rates</div>
      </div>
    </div>

    <!-- Field Details Table -->
    <div class="chart-container field-details">
      <h3>Field Usage Details</h3>
      <div class="table-container">
        <table class="details-table" id="field-details-table">
          <thead>
            <tr>
              <th>Field Name</th>
              <th>Repositories with Field</th>
              <th>Usage Rate</th>
              <th>Progress</th>
            </tr>
          </thead>
          <tbody id="field-details-body">
            <tr>
              <td colspan="4" class="loading">Loading field data...</td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>

  <footer class="footer">
    <p>
      Data source: <code>data/metadata_matrix.json</code> Â· 
      Generated by the OWASP metadata scraper Â·
      Last updated: <span id="last-updated">Loading...</span>
    </p>
  </footer>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="charts.js"></script>
</body>

</html>